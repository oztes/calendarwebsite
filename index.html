<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // This function will handle the data and convert it to JSON
        function handleSheetData(sheetData) {
          const headers = sheetData.values[0];
          const rows = sheetData.values.slice(1); // Exclude the first row of headers
          const jsonData = rows.map((row) => {
            let rowData = {};
            row.forEach((value, index) => {
              rowData[headers[index]] = value;
            });
            return rowData;
          });
      
          // Here you have your data in JSON format
          console.log(jsonData);
      
          // TODO: Use jsonData as needed, e.g., render it into the DOM, etc.
        }
      
        // This function will load your Google Sheet data
        function loadGoogleSheetData() {
          const spreadsheetId = '1Fb7arltsEVfxRTm8o5wJ12Gb90n-oyWgA1po6jAB2ts';
          const apiKey = 'AIzaSyB1RrNZJCDKBkWl4htKf3C0VtuGSj4LZ2s'; 
          const range = 'Sheet1!A1:F'; // Update the range to include all columns you need
      
          // Construct the URL for the Google Sheets API request
          const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`;
      
          // Fetch the data
          fetch(url)
            .then(response => {
              if (!response.ok) {
                throw new Error('Error fetching data: ' + response.statusText);
              }
              return response.json();
            })
            .then(data => {
              // Pass the sheet data to the handler function
              handleSheetData(data);
            })
            .catch(error => {
              console.error('Error:', error);
            });
        }
      
        // Call the function to load the data
        loadGoogleSheetData();
      </script>

</body>
</html>